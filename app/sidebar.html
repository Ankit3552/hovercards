<html ng-csp>
<head>
	<link rel="stylesheet" href="bower_components/angular/angular-csp.css">
	<link rel="stylesheet" href="styles/styles.css">
	<link rel="stylesheet" href="styles/material-design-iconic-font.min.css">
	<style> pre { background-color: pink; font-size: 10pt; } </style>
</head>
<body>
	<div class="ng-cloak" entry="entry" ng-cloak>
		<div class="fade-out-animation" people="people" requests="entry.accounts" selected-index="indexP" ng-if="entry">
			<div class="cards">
				<div content="content" request="entry.content" ng-if="entry.content">
					<div class="card bounce-in-animation" ng-if="content">
						<div ng-include="'templates/'+ content.type + '.html'" ng-if="!content.err"></div>
						<!-- TODO Figure out what triggers the people content to load -->
						<div ng-init="entry.accounts = content.accounts" ng-if="!content.err"></div>

						<div error ng-switch="content.err.code" ng-if="content.err.code">
							<span ng-switch-default>There was a problem with the content!</span>
						</div>
					</div>
				</div>

				<div discussions="discussions" requests="entry.discussions" selected-index="indexD" ng-if="entry.discussions">
					<div class="card bounce-in-animation" ng-if="discussions[0]">
						<div class="comment-top">
							<div class="row">
								<div class="col-9">
									<span>{{ ::discussions[indexD].type | copy}}</span>
								</div>
								<div class="col-3">
									<span>{{ ::discussions[indexD].count | numsmall }}</span>
									<i class="md md-more-vert" ng-click="showMenu = ! showMenu"></i>
								</div>
							</div>
							<div class="menu" ng-show="showMenu">
								<div class="menu-description">
									<div class="row">
										<div class="col-10">
											<p>Sort your favourite</p>
										</div>
										<div class="col-2">X</div>
									</div>
								</div>
								<ul id="sortable" sortable>
								  <li class="ui-state-default" ng-class="{ selected: chosen==='youtube-comments'}" ng-click="chosen='youtube-comments'"><span>Youtube Comments</span></li>
								  <li class="ui-state-default" ng-class="{ selected: chosen==='reddit-comments'}" ng-click="chosen='reddit-comments'"><span>Reddit Discussion</span></li>
								  <li class="ui-state-default" ng-class="{ selected: chosen==='twitter-comments'}" ng-click="chosen='twitter-comments'"><span>Twitter Tweets </span></li>
								</ul>
							</div>
						</div>
						<div ng-include="'templates/'+ discussions[indexD].type + '.html'" ng-if="!discussions[indexD].err"></div>
						<div error ng-switch="discussions[indexD].err.code" ng-if="discussions[indexD].err.code">
							<span ng-switch-default>There was a problem with the discussion!</span>
						</div>
					</div>
				</div>

				<div class="card bounce-in-animation" ng-if="people">
					<div ng-repeat="person in people" ng-click="indexP = $index">
						<div ng-include="'templates/'+ person.selectedAccount.type + '.html'"></div>
					</div>
				</div>
			</div>
			<div class="network-menu">
				<div class="network-menu-container" ng-class="'network-menu-size-' + people[indexP].accounts.length" ng-if="people[indexP].accounts.length">
					<div class="network-menu-option" ng-class="account.type + '-option'" ng-style="{ left: ((-100 * people[indexP].menuOffset) || 0) + 'px' }" ng-repeat="account in people[indexP].accounts" ng-click="people[indexP].selectedAccount = account">
						<span ng-class="account == people[indexP].selectedAccount && 'active'">{{ account.type | copy }}</span>
					</div>
				</div>
				<div ng-show="people[indexP].menuOffset" ng-click="people[indexP].menuOffset = (people[indexP].menuOffset || 0) - 3">Left</div>
				<div ng-show="people[indexP].menuOffset + 3 < people[indexP].accounts.length" ng-click="people[indexP].menuOffset = (people[indexP].menuOffset || 0) + 3">Right</div>
			</div>

			<div class="social-profile" ng-style="!at_page_bottom && { overflow: 'hidden' }" ng-if="people[indexP].selectedAccount">
				<div ng-if="people[indexP].selectedAccount.description">
					<p class="social-profile-description" readmore="people[indexP].selectedAccount.description | htmlify" style="max-height: 100px"></p>
				</div>
				<div more-content="moreContent" request="people[indexP].selectedAccount" ng-if="people[indexP].selectedAccount">
					<div ng-if="moreContent">
						<div ng-include="'templates/' + moreContent.type + '.html'"></div>
					</div>
				</div>
			</div>
		</div>

		<div class="card bounce-in-animation" ng-if="entry.err">
			<div error ng-switch="entry.err.code" ng-if="entry.err.code">
				<span ng-switch-default>There was a problem with the entry!</span>
			</div>
		</div>
	</div>

	<div in-view="at_page_bottom=$inview" style="height: 1px;"></div>

	<link rel="stylesheet" href="styles/subscribe-fix-style.css">
	<script src="bower_components/requirejs/require.js"></script>
	<script src="scripts/config.js"></script>
	<script src="scripts/sidebar-main.js"></script>
</body>
</html>
